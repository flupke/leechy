{% extends "base.html" %}
{% load i18n %}
{% block content %}
<h2>Index of /{{ path }}</h2>

<div class="browser">
    <ul class="directories">
        {% if path %}
        <li><a href="../">Parent directory</a></li>
        {% endif %}
        {% for dir in directories %}
        <li{% if dir in checked_paths %} class="checked"{% endif %}>
            <input type="checkbox" path="{{ dir }}"{% if dir in checked_paths %} checked{% endif %} />
            <a href="./{{ dir }}/">{{ dir }}</a>
        </li>
        {% endfor %}
    </ul>

    <ul class="files">
        {% for furl, fpath, fname, fsize in files %}
        <li{% if fpath in checked_paths %} class="checked"{% endif %}>
            <input type="checkbox" path="{{ fpath }}"{% if fpath in checked_paths %} checked{% endif %} />
            <a href="{{ furl }}">{{ fname }}</a>
            <div class="right">{{ fsize|filesizeformat }}</div>
        </li>
        {% endfor %}
    </ul>
</div>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
<script type="text/javascript">
    $(function()
    {
        $("input[type=checkbox]").change(function()
        {
            var $this = $(this);
            $.get("{% url leechy_update_file_metadata key=key %}", {
                path: $this.attr("path"), 
                attr: "checked",
                value: $this.prop("checked")
            });
            $this.parent().toggleClass("checked");
        });
    });
</script>
{% endblock %}
